{% load static %}


<link rel="stylesheet" href="{% static 'css/shop.css' %}">
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
<link rel="stylesheet" href="style.css">
<script src="script.js"></script>
</head>
<body id="Body">
    <h1 id="Cassa">PRODUKTE</h1>
   

<input  style="margin-bottom: 30px; height: 30px;" class="User" type="number" id="number" placeholder="Hier Kundennummer eingeben">
    
{% for product in all_products %} 
<button id="eins" class="Products" onclick="additem(this, '{{ product.price }}')">{{ product.name }} || {{ product.price }}€</button>
{% endfor %}


    <button onclick="settingsactivate()" id="setting" style="  position: absolute; bottom: 5px; right: 5px; width: 70px; height: 70px; z-index: 1;
    border-radius: 500px; font-size: xx-large;" >⚙️</button>
    <br style="display: none;" class="inputs">
    <input id="i1" class="inputs" placeholder="Name Produkt 1" style="display: none;"> <input id="p1" class="inputs" placeholder="Preis Produkt 1" style="display: none;">
    <br>
    <input id="i2" class="inputs" placeholder="Name Produkt 2" style="display: none;"> <input id="p2" class="inputs" placeholder="Preis Produkt 2" style="display: none;">
    <br>
    <input id="i3" class="inputs" placeholder="Name Produkt 3" style="display: none;"> <input id="p3" class="inputs" placeholder="Preis Produkt 3" style="display: none;">
    <br>
    <input id="i4" class="inputs" placeholder="Name Produkt " style="display: none;"> <input id="p4" class="inputs" placeholder="Preis Produkt 4" style="display: none;">
    <br>

    <button onclick="ausblenden()" class="inputs" style="display: none;">Übernehmen</button>
    


       
    <script>


var price1 = 1
var price2 = 2
var price3 = 3
var price4 = 4
var name1 = 'Produkt1'
var name2 = 'Produkt2'
var name3 = 'Produkt3'
var name4 = 'Produkt4'

window.onload = function() {
/*     price1 = 1
    price2 = 2
    price3 = 3
    price4 = 4

    document.getElementById('eins').innerText ='Produkt1' + ' ||  ' + price1 + "€";
    document.getElementById('zwei').innerText ='Produkt2' + '  ||  ' + price2 + "€";
    document.getElementById('drei').innerText ='Produkt3' + '  ||  ' + price3 + "€";
    document.getElementById('vier').innerText ='Produkt4'+ '  ||  ' + price4 + "€";

    preset()
    ausblenden()

  // Get the data from the Django template */
   
    

    alert('Please configure your settings use the ⚙️ button an scroll down')

    
    
};





  function settingsactivate() {
    
    const inputs = document.getElementsByClassName('inputs');
    
    // Alle Elemente mit der Klasse 'inputs' sichtbar machen
    for (let i = 0; i < inputs.length; i++) {
        inputs[i].style.display = 'block'; // Element anzeigen
    }

    // Elemente nach 2 Sekunden ausblenden
   
}

function ausblenden() {
    const inputs = document.getElementsByClassName('inputs');

    price1 = document.getElementById('p1').value
    price2 = document.getElementById('p2').value
    price3 = document.getElementById('p3').value
    price4 = document.getElementById('p4').value

    name1 = document.getElementById('i1').value
    name2 = document.getElementById('i2').value
    name3 = document.getElementById('i3').value
    name4 = document.getElementById('i4').value

    document.getElementById('eins').innerText = document.getElementById('i1').value + '  ||  ' + price1 + "€";
    document.getElementById('zwei').innerText = document.getElementById('i2').value + '  ||  ' + price2 + "€";
    document.getElementById('drei').innerText = document.getElementById('i3').value + '  ||  ' + price3 + "€";
    document.getElementById('vier').innerText = document.getElementById('i4').value + '  ||  ' + price4 + "€";
    


    for (let i = 0; i < inputs.length; i++) {
            inputs[i].style.display = 'none'; // Element ausblenden
        }

    additemtolist(name1, price1, 1)
    additemtolist(name2, price2, 2)
    additemtolist(name3, price3, 3)
    additemtolist(name4, price4, 4)

    function additemtolist(namePro, pricePro, pronumber) {
    const shop = 'TEST'; 

    
    
    

    // FormData-Instanz erstellen
    let formData = new FormData();
    let token = '{{csrf_token}}'; // CSRF-Token

    
    document.getElementById('number').value = ''

    // Daten zur FormData hinzufügen
    formData.append('shop', shop);
    formData.append('name', namePro);
    formData.append('price', pricePro);
    formData.append('pronumber', pronumber)
    formData.append('csrfmiddlewaretoken', token);

    // Alert-Nachricht anzeigen
    alert(name + " (" + pricePro + "€) wurde zum Shop " + shop + " hinzugefügt" +  ' (' + pronumber + ')'  );

    // Fetch-Anfrage senden
    fetch('/!Test', {
        method: 'POST',
        body: formData
    })
    .then(response => {
        if (!response.ok) {
            throw new Error('Netzwerkantwort war nicht ok.');
        }
        return response.json(); // oder response.text() je nach Rückgabetyp
    })
    .then(data => {
        console.log('Erfolgreich:', data);
    })
    .catch(error => {
        console.error('Es gab ein Problem mit der Fetch-Anfrage:', error);
    });
}

}




function E() {

    document.getElementById('eins').innerText = 'Moinkuchen';
    document.getElementById('zwei').innerText = 'Kartoffelhase';
    document.getElementById('drei').innerText = 'RasberryPiKuchen';
    document.getElementById('vier').innerText = 'RoteKekse';
    price1 = 1;
    price2 = 2;
    price3 = 3;
    price4 = 4;


}
        
    
   function additem(namebut, price) {
    let name = namebut.innerText;
    let number = document.getElementById('number').value;

     
    // FormData-Instanz erstellen
    let formData = new FormData();
    let token = '{{csrf_token}}'; // CSRF-Token

    if (number < 1 ) {
        alert("KEINE KUNDENNUMMER ANGEGEBEN")
        return
    }
    document.getElementById('number').value = ''

    // Daten zur FormData hinzufügen
    formData.append('number', number);
    formData.append('name', name);
    formData.append('price', price);
    formData.append('csrfmiddlewaretoken', token);

    // Alert-Nachricht anzeigen
    alert(name + " (" + price + "€) wurde zum Kunden " + number + " hinzugefügt"   );

    // Fetch-Anfrage senden
    fetch('/Testshop', {
        method: 'POST',
        body: formData
    })
    .then(response => {
        if (!response.ok) {
            throw new Error('Netzwerkantwort war nicht ok.');
        }
        return response.json(); // oder response.text() je nach Rückgabetyp
    })
    .then(data => {
        console.log('Erfolgreich:', data);
    })
    .catch(error => {
        console.error('Es gab ein Problem mit der Fetch-Anfrage:', error);
    });
}

function preset() {

    document.getElementById('i1').value = 'Produkt1'
    document.getElementById('i2').value = 'Produkt2'
    document.getElementById('i3').value = 'Produkt3'
    document.getElementById('i4').value = 'Produkt4'

    document.getElementById('p1').value = 1
    document.getElementById('p2').value = 2
    document.getElementById('p3').value = 3
    document.getElementById('p4').value = 4



}


        


    </script>

</body>
</html>